<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Management - E-Learning Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>
<body class="bg-[#f4f6f9]">

    <body class="bg-[#f4f6f9]">

  <%- include('partials/header.ejs') %>

<div class="flex">
  <%- include('partials/sidebar.ejs') %>

  <main class="flex-1 p-6 space-y-6">

        <!-- COURSE MANAGEMENT CONTENT -->
        <main class="flex-1 p-6 space-y-6" id="courseManagementPage">

            <!-- ================= STATS ================= -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="bg-white rounded-xl shadow-sm p-4 hover:-translate-y-1 hover:shadow-md transition-all">
                    <h6 class="text-gray-600 text-sm">Total Courses</h6>
                    <div class="text-3xl font-bold mt-2">12</div>
                    <div class="text-xs text-green-600 mt-1">‚Üë 2 new this month</div>
                </div>
                <div class="bg-white rounded-xl shadow-sm p-4 hover:-translate-y-1 hover:shadow-md transition-all">
                    <h6 class="text-gray-600 text-sm">Active Courses</h6>
                    <div class="text-3xl font-bold mt-2">8</div>
                    <div class="text-xs text-green-600 mt-1">‚Üë 66% active rate</div>
                </div>
                <div class="bg-white rounded-xl shadow-sm p-4 hover:-translate-y-1 hover:shadow-md transition-all">
                    <h6 class="text-gray-600 text-sm">Total Enrollments</h6>
                    <div class="text-3xl font-bold mt-2">87</div>
                    <div class="text-xs text-green-600 mt-1">‚Üë 12% from last month</div>
                </div>
                <div class="bg-white rounded-xl shadow-sm p-4 hover:-translate-y-1 hover:shadow-md transition-all">
                    <h6 class="text-gray-600 text-sm">Revenue This Month</h6>
                    <div class="text-3xl font-bold mt-2">‚Çπ1.2L</div>
                    <div class="text-xs text-green-600 mt-1">‚Üë 18% growth</div>
                </div>
            </div>

            <!-- ================= CHARTS ================= -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                <div class="bg-white rounded-xl shadow-sm p-4">
                    <h5 class="font-semibold text-lg">Enrollment Trends</h5>
                    <p class="text-xs text-gray-500 mt-1">Monthly enrollment statistics</p>
                    <div class="mt-3">
                        <canvas id="enrollmentChart"></canvas>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-sm p-4">
                    <h5 class="font-semibold text-lg">Top 5 Popular Courses</h5>
                    <p class="text-xs text-gray-500 mt-1">By enrollment count</p>
                    <div class="mt-3">
                        <canvas id="popularCoursesChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- ================= FEATURED COURSES HEADER ================= -->
            <div class="flex justify-between items-center">
                <h2 class="text-xl font-bold">Featured Courses</h2>
                <div class="flex gap-3">
                    <button class="px-5 py-2 bg-blue-600 text-white rounded-lg text-sm font-semibold hover:opacity-90 transition" onclick="showAddCoursePage()">+ Add New Course</button>
                    <button class="px-5 py-2 border border-blue-600 text-blue-600 rounded-lg text-sm font-semibold hover:bg-blue-600 hover:text-white transition" onclick="showAllCourses()">View All Courses</button>
                </div>
            </div>

            <!-- ================= COURSE CARDS ================= -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" id="topCourses">
            <% courses.slice(0,4).forEach(course => { %>

                <div class="bg-white rounded-xl overflow-hidden shadow-sm hover:-translate-y-2 hover:shadow-lg transition-all">

                <div class="w-full h-40 bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-5xl">
                    üìò
                </div>

                <div class="p-4">
                    <h3 class="text-lg font-bold mb-3"><%= course.name %></h3>

                    <div class="space-y-2 mb-4 text-sm text-gray-500">
                    <p>‚è±Ô∏è Duration: <%= course.duration %></p>
                    <p>üë• Enrolled: <%= course.enrolledCount %>/<%= course.intakeLimit %></p>

                    <div class="w-full h-2 bg-gray-200 rounded mt-2">
                        <div
                        class="h-full bg-blue-600 rounded"
                        style="width: <%= (course.enrolledCount / course.intakeLimit) * 100 %> %">
                        </div>
                    </div>
                    </div>

                    <div class="flex justify-between items-center pt-4 border-t">
                    <span class="text-xl font-bold text-blue-600">
                        ‚Çπ<%= course.fee %>
                    </span>

                    <span class="px-3 py-1 rounded-full text-xs font-semibold
                        <%= course.status === 'active'
                        ? 'bg-green-100 text-green-800'
                        : course.status === 'full'
                        ? 'bg-yellow-100 text-yellow-800'
                        : 'bg-red-100 text-red-800' %>">
                        <%= course.status %>
                    </span>
                    </div>
                </div>
                </div>

            <% }) %>
            </div>

            <!-- ================= ALL COURSES TABLE ================= -->
            <div class="bg-white rounded-xl shadow-sm overflow-hidden hidden" id="allCoursesTable">
                <div class="px-6 py-5 border-b flex justify-between items-center">
                    <h2 class="text-xl font-bold">All Courses</h2>
                    <button class="px-5 py-2 border border-blue-600 text-blue-600 rounded-lg text-sm font-semibold hover:bg-blue-600 hover:text-white transition" onclick="hideAllCourses()">‚Üê Back to Cards</button>
                </div>

                <!-- Search and Filter Bar -->
                <div class="px-6 pb-5 pt-4">
                    <div class="flex gap-3 items-center flex-wrap">
                        <input type="text" id="courseSearch" placeholder="üîç Search courses by name..." onkeyup="filterCourses()" class="flex-1 min-w-64 px-4 py-2 border border-gray-200 rounded-lg text-sm outline-none focus:border-blue-600 transition-colors">
                        <select class="px-4 py-2 border border-gray-200 rounded-lg text-sm outline-none focus:border-blue-600 bg-white cursor-pointer min-w-40" id="statusFilter" onchange="filterCourses()">
                            <option value="all">All Status</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="full">Full</option>
                        </select>
                        <select class="px-4 py-2 border border-gray-200 rounded-lg text-sm outline-none focus:border-blue-600 bg-white cursor-pointer min-w-40" id="sortFilter" onchange="filterCourses()">
                            <option value="recent">Recent First</option>
                            <option value="trending">Trending</option>
                            <option value="popular">Most Popular</option>
                            <option value="price-low">Price: Low to High</option>
                            <option value="price-high">Price: High to Low</option>
                        </select>
                    </div>
                </div>

                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Course Name</th>
                                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Duration</th>
                                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Fee</th>
                                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Intake Limit</th>
                                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Enrollments</th>
                                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="courseTableBody">
                            <% courses.forEach(course => { %>
                                <tr class="hover:bg-gray-50 border-t"
                                    data-status="<%= course.status %>"
                                    data-enrollments="<%= course.enrolledCount %>"
                                    data-fee="<%= course.fee %>">

                                <td class="px-6 py-5 text-sm font-semibold">
                                    <%= course.name %>
                                </td>

                                <td class="px-6 py-5 text-sm">
                                    <%= course.duration %>
                                </td>

                                <td class="px-6 py-5 text-sm">
                                    ‚Çπ<%= course.fee %>
                                </td>

                                <td class="px-6 py-5 text-sm">
                                    <%= course.intakeLimit %>
                                </td>

                                <td class="px-6 py-5 text-sm">
                                    <%= course.enrolledCount %>/<%= course.intakeLimit %>
                                </td>

                                <td class="px-6 py-5 text-sm">
                                    <span class="px-3 py-1 rounded-full text-xs font-semibold
                                    <%= course.status === 'active'
                                        ? 'bg-green-100 text-green-800'
                                        : course.status === 'full'
                                        ? 'bg-yellow-100 text-yellow-800'
                                        : 'bg-red-100 text-red-800' %>">
                                    <%= course.status %>
                                    </span>
                                </td>

                                <td class="px-6 py-5 text-sm">
                                    <div class="flex gap-2">
                                    <button class="w-8 h-8 bg-blue-50 rounded">‚úèÔ∏è</button>
                                    <button class="w-8 h-8 bg-red-50 rounded">üóëÔ∏è</button>
                                    </div>
                                </td>
                                </tr>
                            <% }) %>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>

        <!-- ================= ADD COURSE PAGE ================= -->
        <main class="flex-1 p-6 hidden" id="addCoursePage">
            <div class="bg-white rounded-xl shadow-sm p-6">
                <div class="flex items-center justify-between mb-6">
                    <div>
                        <h2 class="text-2xl font-bold">Add New Course</h2>
                        <p class="text-gray-500 text-sm mt-1">Dashboard / Course Management / Add Course</p>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center text-white font-bold">AD</div>
                        <span class="text-sm font-medium">Admin User</span>
                    </div>
                </div>

                <form action="/courses/add" method="POST" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Course Name -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Course Name *</label>
                            <input type="text" name="name" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none" placeholder="Enter course name" required>
                        </div>

                        <!-- Course Fee -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Course Fee (‚Çπ) *</label>
                            <input type="number" name="fee" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none" placeholder="Enter course fee" required>
                        </div>

                        <!-- Duration -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Duration *</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white" name="duration" required>
                                <option value="">Select duration</option>
                                <option value="1" selected>1 Month</option>
                                <option value="2">2 Months</option>
                                <option value="3">3 Months</option>
                                <option value="6">6 Months</option>
                            </select>
                        </div>

                        <!-- Intake Limit -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Monthly Intake Limit *</label>
                            <input type="number" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none" value="10" name="intakeLimit" required>
                            <p class="text-xs text-gray-500 mt-2">Maximum 10 candidates per course per month</p>
                        </div>

                        <!-- Course Description (Full Width) -->
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Course Description *</label>
                            <textarea class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none min-h-[120px]" placeholder="Enter detailed course description" required  name="description" ></textarea>
                        </div>

                        <!-- Syllabus Document -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Syllabus Document</label>
                            <input type="file" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none" accept=".pdf,.doc,.docx">
                        </div>

                        <!-- Activation Status -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Activation Status *</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white" name="status" required>
                                <option value="active" selected>Active</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>

                        <!-- Course Category -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Course Category</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white" name="category" >
                                <option value="">Select category</option>
                                <option value="programming">Programming</option>
                                <option value="design">Design</option>
                                <option value="marketing">Marketing</option>
                                <option value="data-science">Data Science</option>
                            </select>
                        </div>

                        <!-- Instructor -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Instructor</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white">
                                <option value="">Assign later</option>
                                <option value="1">John Doe</option>
                                <option value="2">Jane Smith</option>
                                <option value="3">Robert Johnson</option>
                            </select>
                        </div>
                    </div>

                    <!-- Form Actions -->
                    <div class="flex gap-3 pt-6 border-t">
                        <button type="button" onclick="cancelAddCourse()" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition">Cancel</button>
                        <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition">Save Course</button>
                    </div>
                </form>
            </div>
        </main>

        <!-- ================= EDIT COURSE PAGE ================= -->
        <main class="flex-1 p-6 hidden" id="editCoursePage">
            <div class="bg-white rounded-xl shadow-sm p-6">
                <div class="flex items-center justify-between mb-6">
                    <div>
                        <h2 class="text-2xl font-bold">Edit Course</h2>
                        <p class="text-gray-500 text-sm mt-1">Dashboard / Course Management / Edit Course</p>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center text-white font-bold">AD</div>
                        <span class="text-sm font-medium">Admin User</span>
                    </div>
                </div>

                <form id="editCourseForm" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Course Name -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Course Name *</label>
                            <input type="text" id="editCourseName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none" placeholder="Enter course name" required>
                        </div>

                        <!-- Course Fee -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Course Fee (‚Çπ) *</label>
                            <input type="number" id="editCourseFee" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none" placeholder="Enter course fee" required>
                        </div>

                        <!-- Duration -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Duration *</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white" required>
                                <option value="">Select duration</option>
                                <option value="1" selected>1 Month</option>
                                <option value="2">2 Months</option>
                                <option value="3">3 Months</option>
                                <option value="6">6 Months</option>
                            </select>
                        </div>

                        <!-- Intake Limit -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Monthly Intake Limit *</label>
                            <input type="number" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none" value="10" required>
                            <p class="text-xs text-gray-500 mt-2">Maximum 10 candidates per course per month</p>
                        </div>

                        <!-- Course Description (Full Width) -->
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Course Description *</label>
                            <textarea id="editCourseDescription" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none min-h-[120px]" placeholder="Enter detailed course description" required></textarea>
                        </div>

                        <!-- Syllabus Document -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Syllabus Document</label>
                            <input type="file" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none" accept=".pdf,.doc,.docx">
                            <p class="text-xs text-gray-500 mt-2">Current: course-syllabus.pdf</p>
                        </div>

                        <!-- Activation Status -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Activation Status *</label>
                            <select id="editCourseStatus" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white" required>
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>

                        <!-- Course Category -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Course Category</label>
                            <select id="editCourseCategory" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white">
                                <option value="">Select category</option>
                                <option value="programming">Programming</option>
                                <option value="design">Design</option>
                                <option value="marketing">Marketing</option>
                                <option value="data-science">Data Science</option>
                                <option value="web-development">Web Development</option>
                            </select>
                        </div>

                        <!-- Instructor -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Instructor</label>
                            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none bg-white">
                                <option value="">Assign later</option>
                                <option value="1">John Doe</option>
                                <option value="2">Jane Smith</option>
                                <option value="3">Robert Johnson</option>
                            </select>
                        </div>

                        <!-- Current Enrollments -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Current Enrollments</label>
                            <input type="text" id="editCourseEnrollments" class="w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 outline-none" readonly>
                        </div>
                    </div>

                    <!-- Form Actions -->
                    <div class="flex gap-3 pt-6 border-t">
                        <button type="button" onclick="cancelEditCourse()" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition">Cancel</button>
                        <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition">Update Course</button>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <script>
        // Chart.js configurations
        document.addEventListener('DOMContentLoaded', function() {
            // Enrollment Trends Chart
            const enrollmentCtx = document.getElementById('enrollmentChart').getContext('2d');
            new Chart(enrollmentCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Enrollments',
                        data: [12, 19, 15, 25, 22, 30],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Popular Courses Chart
            const popularCtx = document.getElementById('popularCoursesChart').getContext('2d');
            new Chart(popularCtx, {
                type: 'bar',
                data: {
                    labels: ['Full Stack', 'Python', 'Data Science', 'UI/UX', 'Mobile Dev'],
                    datasets: [{
                        label: 'Students Enrolled',
                        data: [10, 10, 5, 8, 6],
                        backgroundColor: [
                            '#3b82f6',
                            '#10b981',
                            '#f59e0b',
                            '#8b5cf6',
                            '#06b6d4'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 12
                        }
                    }
                }
            });
        });

        // Page navigation functions
        function showAllCourses() {
            document.getElementById('topCourses').classList.add('hidden');
            document.getElementById('allCoursesTable').classList.remove('hidden');
        }

        function hideAllCourses() {
            document.getElementById('topCourses').classList.remove('hidden');
            document.getElementById('allCoursesTable').classList.add('hidden');
        }

        function showAddCoursePage() {
            document.getElementById('courseManagementPage').classList.add('hidden');
            document.getElementById('addCoursePage').classList.remove('hidden');
            document.getElementById('editCoursePage').classList.add('hidden');
        }

        function cancelAddCourse() {
            document.getElementById('addCoursePage').classList.add('hidden');
            document.getElementById('courseManagementPage').classList.remove('hidden');
            document.getElementById('editCoursePage').classList.add('hidden');
        }

        function showEditCoursePage(courseName, fee, category, enrollments) {
            // Hide all pages
            document.getElementById('courseManagementPage').classList.add('hidden');
            document.getElementById('addCoursePage').classList.add('hidden');
            
            // Show edit page
            document.getElementById('editCoursePage').classList.remove('hidden');
            
            // Populate form with existing data
            document.getElementById('editCourseName').value = courseName;
            document.getElementById('editCourseFee').value = fee;
            document.getElementById('editCourseCategory').value = category.toLowerCase().replace(/ /g, '-');
            document.getElementById('editCourseEnrollments').value = enrollments + '/10 students enrolled';
            
            // Set description with sample data
            document.getElementById('editCourseDescription').value = `Comprehensive ${courseName} course covering all essential topics and hands-on projects.`;
            
            // Set status based on enrollment
            document.getElementById('editCourseStatus').value = enrollments > 0 ? 'active' : 'inactive';
        }

        function cancelEditCourse() {
            document.getElementById('editCoursePage').classList.add('hidden');
            document.getElementById('courseManagementPage').classList.remove('hidden');
            document.getElementById('addCoursePage').classList.add('hidden');
        }

        document.getElementById('editCourseForm').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Course updated successfully!');
            cancelEditCourse();
        });

        // Search and Filter functionality
        function filterCourses() {
            const searchValue = document.getElementById('courseSearch').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const sortFilter = document.getElementById('sortFilter').value;
            
            const table = document.getElementById('courseTableBody');
            const rows = Array.from(table.getElementsByTagName('tr'));
            
            // Filter rows
            let filteredRows = rows.filter(row => {
                const courseName = row.cells[0].textContent.toLowerCase();
                const status = row.getAttribute('data-status');
                
                const matchesSearch = courseName.includes(searchValue);
                const matchesStatus = statusFilter === 'all' || status === statusFilter;
                
                return matchesSearch && matchesStatus;
            });
            
            // Sort rows
            filteredRows.sort((a, b) => {
                const enrollmentsA = parseInt(a.getAttribute('data-enrollments'));
                const enrollmentsB = parseInt(b.getAttribute('data-enrollments'));
                const feeA = parseInt(a.getAttribute('data-fee'));
                const feeB = parseInt(b.getAttribute('data-fee'));
                
                switch(sortFilter) {
                    case 'trending':
                    case 'popular':
                        return enrollmentsB - enrollmentsA;
                    case 'price-low':
                        return feeA - feeB;
                    case 'price-high':
                        return feeB - feeA;
                    case 'recent':
                    default:
                        return 0; // Keep original order for recent
                }
            });
            
            // Clear table and append filtered & sorted rows
            table.innerHTML = '';
            filteredRows.forEach(row => {
                row.style.display = '';
                table.appendChild(row);
            });
            
            // Hide rows that don't match
            rows.forEach(row => {
                if (!filteredRows.includes(row)) {
                    row.style.display = 'none';
                }
            });
        }

        // Toggle sidebar
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            if (sidebar.style.display === 'none') {
                sidebar.style.display = 'block';
            } else {
                sidebar.style.display = 'none';
            }
        }

        // Toggle dropdown menus
        function toggleDropdown(menuId) {
            const menu = document.getElementById(menuId);
            menu.classList.toggle('hidden');
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            if (!event.target.closest('.relative')) {
                document.querySelectorAll('#notifMenu, #adminMenu').forEach(menu => {
                    menu.classList.add('hidden');
                });
            }
        });
    </script>
</body>
</html>