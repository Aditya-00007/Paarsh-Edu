<div class="bg-white rounded-xl shadow-sm overflow-hidden" id="allCoursesTable">
    <div class="px-6 py-5 border-b flex justify-between items-center">
        <h2 class="text-xl font-bold">All Courses</h2>
        <!-- <button
            class="px-5 py-2 border border-blue-600 text-blue-600 rounded-lg text-sm font-semibold hover:bg-blue-600 hover:text-white transition"
            onclick="hideAllCourses()">‚Üê Back to Cards</button> -->
    </div>

    <!-- Search and Filter Bar -->
    <div class="px-6 pb-5 pt-4">
        <div class="flex gap-3 items-center flex-wrap">
            <input type="text" id="courseSearch" placeholder="üîç Search courses by name..." onkeyup="filterCourses()"
                class="flex-1 min-w-64 px-4 py-2 border border-gray-200 rounded-lg text-sm outline-none focus:border-blue-600 transition-colors">
            <select
                class="px-4 py-2 border border-gray-200 rounded-lg text-sm outline-none focus:border-blue-600 bg-white cursor-pointer min-w-40"
                id="statusFilter" onchange="filterCourses()">
                <option value="all">All Status</option>
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
                <option value="full">Full</option>
            </select>
            <select
                class="px-4 py-2 border border-gray-200 rounded-lg text-sm outline-none focus:border-blue-600 bg-white cursor-pointer min-w-40"
                id="sortFilter" onchange="filterCourses()">
                <option value="recent">Recent First</option>
                <option value="trending">Trending</option>
                <option value="popular">Most Popular</option>
                <option value="price-low">Price: Low to High</option>
                <option value="price-high">Price: High to Low</option>
            </select>
        </div>
    </div>

    <div class="overflow-x-auto">
        <table class="w-full">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">
                        Course Name</th>
                    <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">
                        Duration</th>
                    <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">
                        Fee</th>
                    <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">
                        Intake Limit</th>
                    <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">
                        Enrollments</th>
                    <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">
                        Status</th>
                    <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">
                        Actions</th>
                </tr>
            </thead>
            <tbody id="courseTableBody">
                <% courses.forEach(course=> { %>
                    <tr class="hover:bg-gray-50 border-t" data-status="<%= course.status %>"
                        data-enrollments="<%= course.enrolledCount %>" data-fee="<%= course.fee %>">

                        <td class="px-6 py-5 text-sm font-semibold">
                            <%= course.title %>
                        </td>

                        <td class="px-6 py-5 text-sm">
                            <%= course.duration %>
                        </td>

                        <td class="px-6 py-5 text-sm">
                            ‚Çπ<%= course.fee %>
                        </td>

                        <td class="px-6 py-5 text-sm">
                            <%= course.intakeLimit %>
                        </td>

                        <td class="px-6 py-5 text-sm">
                            <%= course.enrolledCount %>/<%= course.intakeLimit %>
                        </td>

                        <td class="px-6 py-5 text-sm">
                            <span class="px-3 py-1 rounded-full text-xs font-semibold
                                    <%= course.status === 'active'
                                        ? 'bg-green-100 text-green-800'
                                        : course.status === 'full'
                                        ? 'bg-yellow-100 text-yellow-800'
                                        : 'bg-red-100 text-red-800' %>">
                                <%= course.status %>
                            </span>
                        </td>

                        <td class="px-6 py-5 text-sm">
                            <div class="flex gap-2">
                                <button class="w-8 h-8 bg-blue-50 rounded"
                                    onclick='openEditCourse(<%- JSON.stringify(course) %>)'>
                                    ‚úèÔ∏è
                                </button>

                                
                                <button class="w-8 h-8 bg-green-50 rounded" title="Preview Course"
                                    onclick="previewCourse('<%= course._id %>')">
                                    üëÅÔ∏è
                                </button>

                                <button class="w-8 h-8 bg-red-50 rounded" title="Delete Course"
                                    onclick="deleteCourse('<%= course._id %>')">
                                    üóëÔ∏è
                                </button>

                            </div>
                        </td>
                    </tr>
                    <% }) %>
            </tbody>
        </table>
    </div>
</div>
<script>
    const tableBody = document.getElementById('courseTableBody');
    if (tableBody) {

        const originalRows = Array.from(
            document.getElementById('courseTableBody').children
        );
        const allRows = Array.from(tableBody.children);
        function filterCourses() {
            const searchValue = document.getElementById('courseSearch').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const sortFilter = document.getElementById('sortFilter').value;

            let filteredRows = allRows.filter(row => {
                const courseName = row.cells[0].textContent.toLowerCase();
                const status = row.getAttribute('data-status')?.toLowerCase();

                const matchesSearch = courseName.includes(searchValue);
                const matchesStatus = statusFilter === 'all' || status === statusFilter;

                return matchesSearch && matchesStatus;
            });

            filteredRows.sort((a, b) => {
                const enrollmentsA = Number(a.getAttribute('data-enrollments'));
                const enrollmentsB = Number(b.getAttribute('data-enrollments'));
                const feeA = Number(a.getAttribute('data-fee'));
                const feeB = Number(b.getAttribute('data-fee'));

                switch (sortFilter) {
                    case 'trending':
                    case 'popular':
                        return enrollmentsB - enrollmentsA;
                    case 'price-low':
                        return feeA - feeB;
                    case 'price-high':
                        return feeB - feeA;
                    case 'recent':
                        return allRows.indexOf(a) - allRows.indexOf(b);
                    default:
                        return 0;
                }
            });

            // Clear table and re-render
            tableBody.innerHTML = '';
            filteredRows.forEach(row => tableBody.appendChild(row));
        }

    }


</script>